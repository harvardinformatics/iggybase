{# http://bear-z.com/python/render-bootstrap-3-forms-with-wtforms-and-jinja/ #}
{% macro render_form(form, action_url='', action_text='Submit', class_='', btn_class='btn btn-default') -%}

    <form method="POST" action="{{ action_url }}" role="form" class="{{ class_ }}">
        {{ form.hidden_tag() if form.hidden_tag }}
        {% if caller %}
            {{ caller() }}
        {% else %}
            {% for f in form %}
                {% if f.type == 'BooleanField' %}
                    {{ render_checkbox_field(f) }}
                {% elif f.type == 'RadioField' %}
                    {{ render_radio_field(f) }}
                {% else %}
                    {{ render_field(f) }}
                {% endif %}
            {% endfor %}
        {% endif %}
        <button type="submit" class="{{ btn_class }}">{{ action_text }} </button>
    </form>
{%- endmacro %}

{% macro render_select(option_dict, id) -%}
    <select id="{{id}}">
    {% for name, val in option_dict.items(): %}
        <option value={{val}}>{{name}}</option>
    {% endfor %}
    </select>
{%- endmacro %}

{% macro render_field(field, label_visible=true) -%}
     <div class="form-group {% if field.errors %}has-error{% endif %} {{ kwargs.pop('class_', '') }}">
        {% if field.type != 'HiddenField' and label_visible %}
            <label for="{{ field.id }}" class="control-label">{{ field.label }}</label>
        {% endif %}
        {{ field(class_='form-control', **kwargs) }}
        {% if field.errors %}
            {% for e in field.errors %}
                <p class="help-block">{{ e }}</p>
            {% endfor %}
        {% endif %}
    </div>
{%- endmacro %}

{% macro render_table_headers( table_query, page_form_name = None ) -%}
    {% if table_query.ordered_fields %}
        <table id="{{ table_query.display_name }}_summary_table" class="summary_table display">
            <thead><tr>
                {% if page_form_name == 'action_summary' %}
                    <th>
                        <input type="button" id="select_all" value="Select All/ None">
                    </th>
                {% endif %}
                {% for field in table_query.ordered_fields %}
                    <th>{{ field.replace('_', ' ')|title }}</th>
                {% endfor %}
        </tr></thead>
    </table>
    {% endif %}
{%- endmacro %}

{% macro render_table( table_query, page_form_name = None ) -%}
    {% if table_query.table_rows %}
        <table id="{{ table_query.display_name }}_summary_table" class="summary_table display">
            <thead><tr>
                {% if page_form_name == 'action_summary' %}
                    <th>
                        <input type="button" id="select_all" value="Select All/ None">
                    </th>
                {% endif %}
                {% for key in table_query.table_rows[0].keys() %}
                    <th>{{ key.replace('_', ' ')|title }}</th>
                {% endfor %}
            </tr></thead>
            <tbody>
                {% for row in table_query.table_rows %}
                    <tr>
                    {% if page_form_name == 'action_summary' %}
                        <td><input type="checkbox" class="action_checkbox"></td>
                    {% endif %}
                    {% for value in row.values() %}
                        <td>
                        {% if value['text'] %}
                            {% if value['link'] %}
                                <a href="{{ value['link'] }}">{{ value['text'] }}</a>
                            {% else %}
                                {{ value['text'] }}
                            {% endif %}
                        {% endif %}
                        </td>
                    {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
{%- endmacro %}

{% macro render_detail(table_row) -%}
    <div class="detail">
    {% if table_row %}
        <table id="detail_table">
        {% for name, value in table_row.items() %}
            <tr>
                <td><b>{{ name.replace('_', ' ')|title }}</b></td>
                <td>{{ value['text'] }}</td>
            </tr>
        {% endfor %}
        </table>
    {% endif %}
    </div>
{%- endmacro %}



{% macro render_buttons( buttons ) -%}
    {% for button in buttons %}
        <input {{ button|safe }}>
    {% endfor %}
{%- endmacro %}


{% macro render_scripts( scripts ) -%}
    {% for script in scripts %}
        <script type="text/javascript" src="{{ url_for('static', filename='' ) }}{{ script }}"></script>
    {% endfor %}
{%- endmacro %}
